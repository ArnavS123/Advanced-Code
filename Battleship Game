#include <stdio.h>
#include <stdlib.h>

#define INITIALMAXHEALTH 1000
#define MINONE 25
#define MAXONE 75
#define MINTWO 75
#define MAXTWO 150
#define MINTHREE 150
#define MAXTHREE 350

int Seed();
int Randnum(int, int);
int Choose();
void Stats(char[]);
void Move();
void Attack();
void AttackEffects(int, int);
void Improve();
void Rename(char*);

int money = 100;
int health = INITIALMAXHEALTH;
int cloth = 0;
int wood = 0;
int metal = 0;
int storage = 500;
int loc = 1;
int multiplier = 1;

int main(void)
{
  int seed;
  int choice;
  char name[35] = "Your Ship";

  seed = Seed();
  srand(seed);

  printf("\nWelcome to the battleship game!\n\nHere are your choices:\nChoice #1: Display Stats\nChoice #2: Move\nChoice #3: Attack\nChoice #4: Upgrade/Repair\nChoice #5: Rename Ship\nChoice #6: Exit\n");

  do
  {
    if (health <= 0)
    {
      printf("\n%s has sunk! Game over!\n", name);
      break;
    }
    choice = Choose();
    switch (choice)
    {
      case 1:
        Stats(name);
        break;
      case 2:
        Move();
        break;
      case 3:
        Attack();
        break;
      case 4:
        Improve();
        break;
      case 5:
        Rename(name);
        break;
    }
  } while (choice != 6);

  printf("\nThank you for playing!");
  
  return (0);
}

int Seed()
{
  int seed;

  do
  {
    printf("Please enter a seed -> ");
    scanf("%d", &seed);
    if (seed <= 0)
    {
      printf("\nError! Seed value must be positive (above 0)!\n\n");
    }
  } while (seed <= 0);

  return (seed);
}

int Randnum(int maxval, int minval)
{
  int num;

  num = rand() % (maxval - minval) + minval;
  
  return (num);
}

int Choose()
{
  int choice;

  do
  {
    printf("\nCurrent health: %d\n", health);
    printf("Please select a choice (1 - 6) - > ");
    scanf("%d", &choice);
    if (choice < 1 || choice > 6)
    {
      printf("\nError! Choose an option between 1 and 6!\n\n");
    }
  } while (choice < 1 || choice > 6);

  return (choice);
}

void Stats(char name[])
{
  printf("\nStats of '%s':", name);
  printf("\nMoney: %d", money);
  printf("\nHealth: %d / %d", health, INITIALMAXHEALTH);
  printf("\nCloth: %d / %d", cloth, storage);
  printf("\nWood: %d / %d", wood, storage);
  printf("\nMetal: %d / %d\n", metal, storage);
}

void Move()
{
  char yn;
  int curloc = loc;

  printf("\nThere are three locations:\nlocation 1 - Easy Difficulty\nlocation 2 - Medium Difficulty\nlocation 3 - Hard Difficulty\n\nCurrent location: %d", loc);
  do
  {
    printf("\n\nWould you like to move? Enter y or n -> ");
    scanf(" %c", &yn);
    if (yn != 'y' && yn != 'n')
    {
      printf("\nError! Enter y for yes or n for no!");
    }
  } while (yn != 'y' && yn != 'n');

  if (yn == 'y')
  {
    do
    {
      printf("\nMove from location %d to location -> ", curloc);
      scanf("%d", &loc);
      if (loc > 3 || loc < 1)
      {
        printf("\nError! Choose location 1, 2, or 3!\n");
      }
    } while (loc > 3 || loc < 1);
    printf("\nSucessfully moved to location %d\n", loc);
  }
  else
  {
    printf("\nStayed at location %d\n", loc);
  }
}

void Attack()
{
  switch (loc)
  {
    case 1:
      AttackEffects(MAXONE, MINONE);
      break;
    case 2:
      AttackEffects(MAXTWO, MINTWO);
      break;
    case 3:
      AttackEffects(MAXTHREE, MINTHREE);
      break;
  }
}

void AttackEffects(int max, int min)
{
  money += Randnum(max, min);
  health -= Randnum(max, min);
  cloth += Randnum(max, min);
  wood += Randnum(max, min);
  metal += Randnum(max, min);
}

void Improve()
{
  int newhealth;
  
  // Upgrades can be 1, 2, 3, 4, 5.. (multiplier) times INITIALMAXHEALTH
  // Repair: same exact thing
  // I'll let players upgrade a lot for health (maybe 10), but only go up to 3 or 5 for storage
}

void Rename(char *name)
{
  char yn;

  printf("\nCurrent name: %s", name);
  do
  {
    printf("\n\nWould you like to change this name? Enter y or n -> ");
    scanf(" %c", &yn);
    if (yn != 'y' && yn != 'n')
    {
      printf("\nError! Enter y for yes or n for no!");
    }
  } while (yn != 'y' && yn != 'n');

  if (yn == 'y')
  {
    printf("\nChange '%s' to -> ", name);
    scanf("%s", name);
    printf("\nNew ship name now saved as: %s\n", name);
  }
  else
  {
    printf("\nPrevious name of '%s' retained\n", name);
  }
}
